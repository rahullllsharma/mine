import{createContext as e,useState as t,createElement as n,useContext as r,useRef as o,useEffect as a}from"react";var i=function(){var e,t={},n=[],r="__LSM__";try{e="undefined"!=typeof sessionStorage?window.sessionStorage:{}}catch(t){e={}}return{updateStore:function(n){try{t=JSON.parse(e.getItem(r)||"")||n}catch(e){t=n}},saveStore:function(){e.setItem(r,JSON.stringify(t))},get middleWares(){return n},set middleWares(e){n=e},get state(){return t},set state(e){t=e},get name(){return r},set name(e){r=e},get storageType(){return e},set storageType(t){e=t}}}(),s=e(void 0),_=function(e){var r=e.children,o=t(i.state);return n(s.Provider,{value:{state:o[0],setState:o[1]}},r)},d="onAction";function u(e,t){var n,r,o;t&&(t.name&&(i.name=t.name),t.storageType&&(i.storageType=t.storageType),t.middleWares&&(i.middleWares=t.middleWares),t.persist&&(d=t.persist)),"production"!==process.env.NODE_ENV&&(n=i.storageType,r=i.name,o=i.state,"undefined"!=typeof window&&(window.__LSM__=r,window.__LSM_NAME__=r,window.__LSM_DEBUG__=function(e){return n.setItem("___LSM_DEBUG__",e)},window.__LSM_RESET__=function(){return n.removeItem(r)},window.__LSM_GET_STORE__=function(){return n.getItem(r)},window.__LSM_SAVE_TO__=function(e){return window.localStorage.setItem(e,JSON.stringify(o))},window.__LSM_LOAD__=function(e){return n.setItem(r||"___LSM_DEBUG__",e.data||window.localStorage.getItem(e.storeName)||"")})),i.updateStore(e)}function c(e){var t,n=(t=r(s),"production"!==process.env.NODE_ENV&&(t||console.error("StateMachine context is undefined, please verify you are calling useStateMachine() as child of a <StateMachineProvider> component.")),t),_=n.state,u=n.setState,c=o(Object.entries(e||{}).reduce(function(e,t){var n;return Object.assign({},e,((n={})[t[0]]=function(e,t){return function(n){"production"!==process.env.NODE_ENV&&(window.__LSM_NAME__=t.name),i.state=t(i.state,n),i.middleWares&&(i.state=i.middleWares.reduce(function(e,r){return r(e,t.name,n)||e},i.state)),e(i.state),"onAction"===d&&i.saveStore()}}(u,t[1]),n))},{}));return a(function(){"beforeUnload"===d&&(window.onbeforeunload=function(){return i.saveStore()})},[]),{actions:c.current,state:_}}export{_ as StateMachineProvider,u as createStore,c as useStateMachine};
//# sourceMappingURL=little-state-machine.es.js.map
